name: Send Email on Push

on:
  push:
    branches: [main] # Trigger when pushing to 'main' branch

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
    - name: Get Current Time
      id: time
      run: echo "time=$(date -u +"%Y-%m-%d %H:%M:%S UTC")" >> $GITHUB_OUTPUT

    - name: Send Email
      uses: dawidd6/action-send-mail@v3
      with:
        server_address: smtp.gmail.com
        server_port: 465
        username: ${{ secrets.EMAIL_USERNAME }}
        password: ${{ secrets.EMAIL_PASSWORD }}

        subject: "ğŸ”¥ New Push to Main by ${{ github.actor }} â€“ ${{ github.event.head_commit.message }}"

        to: ${{ secrets.EMAIL_TO }}
        from: GitHub Actions <${{ secrets.EMAIL_USERNAME }}>
        content_type: html/text

        body: |
          <div style="font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px;">
            <div style="max-width: 600px; margin: auto; background-color: #ffffff; padding: 20px; border-radius: 8px; border: 1px solid #ddd;">
              <h2 style="color: #333333;">ğŸš¨ New Push to <code style="background-color:#eee;padding:2px 4px;border-radius:4px;">main</code></h2>
              
              <p><strong>ğŸ“Œ Repository:</strong> <a href="https://github.com/${{ github.repository }}" style="color:#007bff;">${{ github.repository }}</a></p>
              
              <p><strong>ğŸ‘¤ Author:</strong> ${{ github.event.head_commit.author.name }} &lt;${{ github.event.head_commit.author.email }}&gt;</p>
              
              <p><strong>ğŸ™‹ Pushed By:</strong> @${{ github.actor }}</p>
              
              <p><strong>ğŸ”— Commit:</strong> <a href="https://github.com/${{ github.repository }}/commit/${{ github.sha }}" style="color:#007bff;">${{ github.sha }}</a></p>
              
              <p><strong>ğŸ“ Message:</strong> <em>${{ github.event.head_commit.message }}</em></p>
              
              <p><strong>ğŸ•’ Time:</strong> ${{ steps.time.outputs.time }}</p>

              <hr style="margin: 20px 0;" />

              <footer style="text-align: center; font-size: 12px; color: #888888;">
                Sent by <strong>GitHub Actions</strong> ğŸš€ <br />
                <a href="https://github.com/${{ github.repository }}" style="color:#888888;text-decoration:none;">${{ github.repository }}</a>
              </footer>
            </div>
          </div>
